/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/scipy/__init__.py:132: UserWarning: A NumPy version >=1.21.6 and <1.28.0 is required for this version of SciPy (detected version 2.3.2)
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.3.2 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 2, in <module>
  File "/Users/hawzhin/AutoResolve/autorez/src/embedders/clip_embedder.py", line 2, in <module>
    import open_clip
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/open_clip/__init__.py", line 3, in <module>
    from .coca_model import CoCa
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/open_clip/coca_model.py", line 15, in <module>
    from .model import CLIPTextCfg, CLIPVisionCfg, _build_vision_tower, _build_text_tower
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/open_clip/model.py", line 18, in <module>
    from .hf_model import HFTextEncoder
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/open_clip/hf_model.py", line 13, in <module>
    from transformers import AutoModel, AutoTokenizer, AutoConfig, PretrainedConfig
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/transformers/utils/import_utils.py", line 2292, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/transformers/utils/import_utils.py", line 2320, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/transformers/models/auto/modeling_auto.py", line 23, in <module>
    from .auto_factory import (
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/transformers/models/auto/auto_factory.py", line 43, in <module>
    from ...generation import GenerationMixin
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/transformers/utils/import_utils.py", line 2292, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/transformers/utils/import_utils.py", line 2320, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/transformers/generation/utils.py", line 62, in <module>
    from .candidate_generator import (
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/transformers/generation/candidate_generator.py", line 29, in <module>
    from sklearn.metrics import roc_curve
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/sklearn/__init__.py", line 73, in <module>
    from .base import clone  # noqa: E402
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/sklearn/base.py", line 19, in <module>
    from .utils._metadata_requests import _MetadataRequester, _routing_enabled
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/sklearn/utils/__init__.py", line 9, in <module>
    from ._chunking import gen_batches, gen_even_slices
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/sklearn/utils/_chunking.py", line 11, in <module>
    from ._param_validation import Interval, validate_params
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/sklearn/utils/_param_validation.py", line 14, in <module>
    from scipy.sparse import csr_matrix, issparse
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/scipy/sparse/__init__.py", line 274, in <module>
    from ._csr import *
  File "/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/scipy/sparse/_csr.py", line 11, in <module>
    from ._sparsetools import (csr_tocsc, csr_tobsr, csr_count_blocks,
AttributeError: _ARRAY_API not found
Testing CLIP embedder...
✓ CLIP embedder initialized successfully
✓ Text embeddings shape: (2, 1024)
✓ CLIP embedder functional
